# 3 <= N, M <= 8